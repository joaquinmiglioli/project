<?xml version="1.0" encoding="UTF-8"?>

<?import com.example.demo.ui.ToggleSwitch?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Menu?>
<?import javafx.scene.control.MenuBar?>
<?import javafx.scene.control.MenuItem?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>

<BorderPane prefHeight="600.0" prefWidth="800.0" xmlns="http://javafx.com/javafx/24.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.example.demo.Controller">

    <top>
        <VBox>
            <MenuBar>
                <Menu text="File" />
                <Menu text="View">
                    <MenuItem fx:id="menuAlerts" text="Alerts" />
                    <MenuItem fx:id="menuViolationsView" text="Violations Log"/>
                    <MenuItem fx:id="menuReports" text="Reports"/>
                </Menu>
                <Menu text="Help" />
            </MenuBar>

            <!-- Filtros con toggles, centrados -->
            <HBox alignment="CENTER" spacing="28" style="-fx-padding: 8 8;">
                <VBox alignment="CENTER" spacing="4">
                    <Label text="Show Map" />
                    <ToggleSwitch fx:id="swMap" />
                </VBox>
                <VBox alignment="CENTER" spacing="4">
                    <Label text="Show Vehicles" />
                    <ToggleSwitch fx:id="swVehicles" />
                </VBox>
                <VBox alignment="CENTER" spacing="4">
                    <Label text="Show Semaphores" />
                    <ToggleSwitch fx:id="swSemaphores" />
                </VBox>
                <VBox alignment="CENTER" spacing="4">
                    <Label text="Show Radars" />
                    <ToggleSwitch fx:id="swRadars" />
                </VBox>
                <VBox alignment="CENTER" spacing="4">
                    <Label text="Show Cameras" />
                    <ToggleSwitch fx:id="swCameras" />
                </VBox>
                <VBox alignment="CENTER" spacing="4">
                    <Label text="Show Fails" />
                    <ToggleSwitch fx:id="swFails" />
                </VBox>
            </HBox>
        </VBox>
    </top>

    <center>
        <!-- Contenedor de capas -->
        <StackPane fx:id="stack" prefHeight="600.0" prefWidth="800.0">

            <!-- Capa 1: Mapa + botones de cámaras -->
            <AnchorPane fx:id="mapLayer">

            </AnchorPane>

            <StackPane fx:id="cameraLayer" managed="false" visible="false">
                <ImageView fx:id="cameraImage" preserveRatio="true" smooth="true" />

                <!-- Barra de servicios abajo-centro, NO ocupa toda el área -->
                <HBox fx:id="serviceBar" alignment="CENTER" maxHeight="-Infinity" maxWidth="-Infinity" pickOnBounds="false" spacing="10" style="-fx-background-color: rgba(0,0,0,0.45); -fx-background-radius: 8;" StackPane.alignment="BOTTOM_CENTER">
                    <StackPane.margin>
                        <Insets bottom="10.0" />
                    </StackPane.margin>
                    <padding>
                        <Insets bottom="6.0" left="10.0" right="10.0" top="6.0" />
                    </padding>

                    <Button fx:id="btnPolice" text="POLICE" />
                    <Button fx:id="btnFireman" text="FIREMAN" />
                    <Button fx:id="btnAmbulance" text="AMBULANCE" />
                </HBox>

                <!-- Back colocado DESPUÉS para quedar por encima -->
                <Button fx:id="btnBack" style="-fx-background-color: rgba(0,0,0,0.6); -fx-text-fill: white;" text="Back" StackPane.alignment="BOTTOM_LEFT">
                    <StackPane.margin>
                        <Insets bottom="10.0" left="10.0" />
                    </StackPane.margin>
                </Button>

                <!-- Toast -->
                <Label fx:id="toast" managed="false" style="-fx-background-color: rgba(0,0,0,0.8); -fx-text-fill: white; -fx-padding: 10 14; -fx-background-radius: 10; -fx-font-weight: bold; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.6), 12, 0.4, 0, 0);" text="" visible="false" StackPane.alignment="TOP_CENTER">
                    <StackPane.margin>
                        <Insets top="16.0" />
                    </StackPane.margin>
                </Label>
            </StackPane>

            <!-- ===== Detalle de intersección (A / B) ===== -->
            <StackPane fx:id="tlDetailLayer" managed="false" visible="false" StackPane.alignment="CENTER">
                <VBox alignment="CENTER" maxWidth="320.0" spacing="10" style="-fx-background-color: rgba(0,0,0,0.65); -fx-padding: 16; -fx-background-radius: 12;">
                    <Label style="-fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 16;" text="Intersection detail" />

                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Label style="-fx-text-fill: white;" text="A (principal)" />
                        <Region fx:id="dotA" prefHeight="16" prefWidth="16" style="-fx-background-color: #22c55e; -fx-background-radius: 8;" />
                        <Label fx:id="lblA" style="-fx-text-fill: white;" text="" />
                    </HBox>

                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Label style="-fx-text-fill: white;" text="B (secondary)" />
                        <Region fx:id="dotB" prefHeight="16" prefWidth="16" style="-fx-background-color: #ef4444; -fx-background-radius: 8;" />
                        <Label fx:id="lblB" style="-fx-text-fill: white;" text="" />
                    </HBox>

                    <HBox alignment="CENTER" spacing="8">
                        <Button fx:id="btnFlashing" text="Intermittent"/>
                        <Button fx:id="btnNormal"   text="Normal"/>
                    </HBox>

                    <Button fx:id="btnBackTL" text="Back" />
                </VBox>
            </StackPane>

            <!-- Toast pequeño para el MAPA (top-right) -->
            <Label fx:id="toastMap"
                   text=""
                   visible="false" managed="false" mouseTransparent="true"
                   StackPane.alignment="TOP_RIGHT"
                   style="-fx-background-color: rgba(0,0,0,0.75);
              -fx-text-fill: white;
              -fx-padding: 6 10;
              -fx-background-radius: 10;
              -fx-font-size: 12;">
                <StackPane.margin>
                    <Insets top="12.0" right="12.0"/>
                </StackPane.margin>
            </Label>
        </StackPane>
    </center>
</BorderPane>
